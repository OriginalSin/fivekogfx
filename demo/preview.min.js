/*
 Created by FIVEKO.com 2017

 The source code is designed and developed for educational purposes only. 
 It is designed for no other purpose and neither the authors nor their institutions 
 accept any liability concerning its use.

*/
window.addEventListener("load",function(g){function r(a){var b=a.width||a.videoWidth;a=a.height||a.videoHeight;var c=(480<document.documentElement.clientWidth?480:document.documentElement.clientWidth-100)/Math.max(b,a);e.width=b*c;e.height=a*c}function t(a,b){var c=document.getElementsByTagName("video")[0];if(!c){var d=function(){c.play();c.muted=!0;r(c);clearInterval(l);l=setInterval(function(){u.update()},30)},l,c=document.createElement("video");c.addEventListener("canplaythrough",d,!0);c.addEventListener("ended",
function(){clearInterval(l)},!0);e.onclick=function(){c.paused?d():(c.pause(),clearInterval(l))}}q=c;c.src=a}function v(a,b){h.onload=function(){r(h);e.getContext("2d").drawImage(h,0,0,e.width,e.height);b()};a?h.src=a:b();q=h}function w(a,b,c,e){this.controls=[];this.name=a;this.init=function(){this.controls=[];b.call(this);this.update.call(this)};this.update=function(){var a=new Date;e();for(var b=[],d=0;d<this.controls.length;d++)b.push(this.controls[d].value);c.apply(this,b);b=new Date;document.getElementById("log").innerText=
"Elapsed: "+(b-a)+" ms"};this.reset=e}if(g=document.querySelector("div[data-role=preview]")){var u=null,h=new Image,q=h,e=document.createElement("canvas");(function(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("style");c.setAttribute("type","text/css");c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a));b.appendChild(c)})(".input-group-addon.title{min-width:120px;}.input-group-addon.value{width:60px;}");var k=document.createElement("div"),m=
document.createElement("input"),n=document.createElement("button"),p=document.createElement("button"),d=document.createElement("select");m.setAttribute("type","file");m.style.display="none";m.addEventListener("change",function(a){var b=URL.createObjectURL(a.target.files[0]);a=a.target.files[0].type;(a="image"==a.substring(0,5)?v:"video"==a.substring(0,5)?t:null)&&a(b,function(){URL.revokeObjectURL(b)})});p.textContent="Camera";p.style.margin="10px";p.style.width="100px";n.textContent="Browse";n.style.margin=
"10px";n.style.width="100px";n.onclick=function(){m.click();return!1};p.onclick=function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;navigator.getUserMedia&&navigator.getUserMedia({video:!0},function(a){var b=window.URL.createObjectURL(a);t(b,function(){URL.revokeObjectURL(b)})},function(a){alert("Failed to initialize camera!")})};d.onchange=function(){document.getElementById("controls").innerHTML=
"";var a=this.options[this.selectedIndex].filter;u=this.options[this.selectedIndex].filter;a.init();a.update();return!1};g.insertBefore(e,g.firstChild);g.insertBefore(k,g.firstChild);k.appendChild(m);k.appendChild(n);k.appendChild(p);k.appendChild(d);window.reloadImage=function(){e.getContext("2d").drawImage(h,0,0,e.width,e.height)};window.redraw=function(){e.getContext("2d").drawImage(q,0,0,e.width,e.height)};w.prototype.add=function(a){this.controls.push(a)};window.selectFilter=function(a){d.style.display=
"none";for(var b=0;b<d.options.length;b++)if(d.options[b].text===a){d.selectedIndex=b;break}};window.addFilter=function(a){var b=document.createElement("option");b.text=a.name;b.filter=a;d.add(b)};window.Filter=w;window.createSlider=function(a,b,c,e,d,g,h,k){var l=document.createElement("div");l.innerHTML='<div class="input-group" style="max-width:420px; margin:auto;"><span class="input-group-addon title">'+c+'</span><input type="range" class="form-control" id="'+b+'" ><span class="input-group-addon value">'+
e+"</span></div>";a.appendChild(l);var f=document.getElementById(b);f.min=d;f.max=g;f.step=h;f.value=e;f.oninput=f.onchange=function(a){f.nextSibling.innerText=this.value};f.onmouseup=f.ontouchend=k;return f};window.createButton=function(a,b,c,e){var d=document.createElement("button");d.addClass="btn btn-primary";d.innerText=c;d.name=b;a.appendChild(d);a.onclick=e;return d};var k=g.getAttribute("data-source"),x=g.getAttribute("data-callback");v(k,function(){window[x](e,e);d.onchange();1===d.options.length&&
(d.style.display="none")})}},!0);
